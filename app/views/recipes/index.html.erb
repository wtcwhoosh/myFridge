<h1>Drink Recipes</h1>
<% if flash[:error] %>
    <div class="alert alert-danger">
      <%= flash[:error] %>
    </div>
<% end %>


<%= form_tag(recipes_path, :method => "get", id: "search-form") do %>
    <%= text_field_tag :search, params[:search], placeholder: "Search recipes" %>
    <%= submit_tag "Search" %>
<% end %>

<table class="sortable">


  <tr>
    <th>Name</th>

    <th>Ratings</th>
    <th></th>
    <th></th>
  </tr>

<% @recipes.each do |recipe| %>
  <tr>
    <td><%= image_tag 'drinkpic.png' %><%= link_to recipe.name, recipe %></td>
    <td><% feedbackSum = 0.0 %>
      <% feedbackCount = 0.0 %>
      <% recipe.feedbacks.each do |i| %>
          <% feedbackSum += i.rating %>
          <% feedbackCount += 1.0 %>
      <% end %>

      <% if recipe.feedbacks.empty? %>
          No feedback
      <% else %>
          <%= number_with_precision(feedbackSum/feedbackCount, :precision => 2)%>
      <% end %></td>

  </tr>
<% end %>
</table>

<br />


